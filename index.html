<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Máy Tính Điểm Cuối Kỳ</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <i class="fas fa-calculator"></i>
                <h1>Máy Tính Điểm Cuối Kỳ</h1>
            </div>
            <p class="subtitle">Tính toán điểm cần thiết để đạt mục tiêu của bạn</p>
        </header>

        <!-- Help Button -->
        <div class="help-button-wrapper">
            <button id="help-btn" class="help-btn">
                <i class="fas fa-question-circle"></i>
                Hướng dẫn cách tính điểm
            </button>
        </div>

        <!-- Welcome/Warning Modal (Separate from help modal) -->
        <div id="welcome-modal" class="welcome-modal-overlay">
            <div class="welcome-modal-box">
                <div class="welcome-modal-header">
                    <h2>
                        <i class="fas fa-exclamation-triangle"></i>
                        Lưu Ý Quan Trọng
                    </h2>
                </div>
                <div class="welcome-modal-body">
                    <div class="warning-content">
                        <div class="warning-icon">
                            <i class="fas fa-info-circle"></i>
                        </div>
                        <div class="warning-text">
                            <h3>Cách tính điểm dựa trên bảng slide trong Google Drive</h3>
                            <p>Công cụ này chỉ mang tính chất <strong>tham khảo</strong>. Có thể sẽ có những sai lệch nhỏ khi so với điểm tổng kết chính thức do:</p>
                            <ul>
                                <li><i class="fas fa-chevron-right"></i> Cách làm tròn điểm của hệ thống</li>
                                <li><i class="fas fa-chevron-right"></i> Điều chỉnh điểm từ giảng viên</li>
                                <li><i class="fas fa-chevron-right"></i> Các yếu tố đánh giá khác chưa được tính</li>
                            </ul>
                            <p class="drive-link">
                                <i class="fas fa-link"></i> 
                                Tham khảo bảng điểm gốc: 
                                <a href="https://drive.google.com/file/d/1cC-34fjkioRAOEYgHqeM6VqQIFEBRgT_/view" target="_blank" rel="noopener">
                                    Google Drive Slide
                                </a>
                            </p>
                            <p class="note-text">
                                <i class="fas fa-lightbulb"></i>
                                Kết quả từ công cụ này giúp bạn ước tính điểm cần đạt, nhưng vui lòng kiểm tra điểm chính thức từ giảng viên.
                            </p>
                        </div>
                    </div>
                    <button id="understand-btn" class="understand-btn" onclick="hieu()">
                        <i class="fas fa-check"></i>
                        Tôi đã hiểu
                    </button>
                </div>
            </div>
        </div>

        <!-- Help Modal -->
        <div id="help-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>
                        <i class="fas fa-book"></i>
                        Cơ Cấu Điểm & Cách Tính
                    </h2>
                    <button id="close-modal" class="close-btn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <img src="./img/diem.jpg" alt="Bảng điểm" class="grade-table-img" id="grade-table-img">
                    
                    <div class="explanation">
                        <h3><i class="fas fa-info-circle"></i> Chi tiết cách tính:</h3>
                        
                        <div class="calc-section">
                            <h4><i class="fas fa-user-check"></i> Chuyên cần (10%)</h4>
                            <p>Tỉ lệ chuyên cần 90% trở lên được tính là 10%</p>
                            <div class="formula">Điểm = 1.0 điểm (nếu đạt ≥90% chuyên cần)</div>
                        </div>

                        <div class="calc-section">
                            <h4><i class="fas fa-chalkboard-teacher"></i> Điểm trên lớp (30%)</h4>
                            <p><strong>a) Minitest (20%):</strong></p>
                            <ul>
                                <li>Quy mỗi bài về thang 10</li>
                                <li>Ví dụ nhóm 20: 16/20 = 8.0, 20/20 = 10.0, 13/20 = 6.5, ...</li>
                                <li>Ví dụ nhóm 30: 27/30 = 9.0, 18/30 = 6.0, 28/30 = 9.33, ...</li>
                                <li>Tính trung bình: (8.0 + 10.0 + 6.5 + ... + 9.33) / 12 = 7.94/10</li>
                                <li>Quy về 20%: 7.94 × 20% = <strong>1.59 điểm</strong></li>
                            </ul>
                            
                            <p><strong>b) Bài tập về nhà (10%):</strong></p>
                            <ul>
                                <li>Full điểm BTVN = <strong>1.0 điểm</strong></li>
                            </ul>
                            
                            <div class="formula">Điểm trên lớp = 1.59 + 1.0 = 2.59/3.0</div>
                        </div>

                        <div class="calc-section">
                            <h4><i class="fas fa-file-alt"></i> Kamatsu - Giữa kỳ (30%)</h4>
                            <ul>
                                <li>Trung bình các bài Kamatsu</li>
                                <li>Ví dụ: (96 + 73 + 67) / 3 = 78.67/100</li>
                                <li>Quy về thang 10: 78.67% × 10 = 7.87/10</li>
                                <li>Quy về 30%: 7.87 × 30% = <strong>2.36 điểm</strong></li>
                            </ul>
                        </div>

                        <div class="calc-section">
                            <h4><i class="fas fa-clipboard-check"></i> Điểm cuối kỳ (30%)</h4>
                            <p>Chỉ được phép nghỉ tối đa <strong>12 buổi (A+UA)</strong> hoặc tối đa <strong>4 buổi không phép (UA)</strong>.</p>
                            <p>Nếu vượt quá <i class="fas fa-arrow-right"></i> <strong>không được tham gia thi cuối kỳ</strong></p>
                        </div>

                        <div class="calc-section total">
                            <h4><i class="fas fa-calculator"></i> TỔNG ĐIỂM</h4>
                            <div class="formula">
                                Tổng = Chuyên cần + Trên lớp + Kamatsu + Cuối kỳ<br>
                                = 1.0 + 2.59 + 2.36 + (Điểm CK × 30%)<br>
                                = <strong>5.95 + (Điểm CK × 0.3)</strong>
                            </div>
                        </div>

                        <div class="calc-section">
                            <h4><i class="fas fa-flag-checkered"></i> Mục tiêu điểm:</h4>
                            <ul>
                                <li><i class="fas fa-check-circle text-green"></i> <strong>Qua môn:</strong> ≥ 4.0 điểm</li>
                                <li><i class="fas fa-star text-blue"></i> <strong>Điểm B:</strong> ≥ 7.0 điểm</li>
                                <li><i class="fas fa-trophy text-yellow"></i> <strong>Điểm A:</strong> ≥ 8.5 điểm</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Grading System Info -->
        <section class="grading-system">
            <h2 class="section-title">
                <i class="fas fa-award"></i>
                Cơ Cấu Điểm
            </h2>
            <div class="grade-grid">
                <div class="grade-card">
                    <div class="grade-percent blue">10%</div>
                    <div class="grade-label">Chuyên cần</div>
                </div>
                <div class="grade-card">
                    <div class="grade-percent green">20%</div>
                    <div class="grade-label">Minitest</div>
                </div>
                <div class="grade-card">
                    <div class="grade-percent purple">10%</div>
                    <div class="grade-label">BTVN</div>
                </div>
                <div class="grade-card">
                    <div class="grade-percent yellow">30%</div>
                    <div class="grade-label">Kamatsu</div>
                </div>
                <div class="grade-card">
                    <div class="grade-percent orange">30%</div>
                    <div class="grade-label">Cuối kỳ</div>
                </div>
            </div>
        </section>

        <!-- Input Section -->
        <section class="input-section">
            <div class="input-grid">
                <!-- Minitest Input -->
                <div class="input-card">
                    <label class="input-label blue">
                        <i class="fas fa-edit"></i>
                        Điểm Minitest (mỗi điểm một dòng)
                    </label>
                    <textarea 
                        id="minitest-input" 
                        placeholder="16/20&#10;20/20&#10;13/20&#10;27/30&#10;..."
                    ></textarea>
                    <p class="input-hint">Ví dụ: 16/20, 20/20, 27/30</p>
                </div>

                <!-- Kamatsu Input -->
                <div class="input-card">
                    <label class="input-label yellow">
                        <i class="fas fa-file-signature"></i>
                        Điểm Kamatsu (mỗi điểm một dòng)
                    </label>
                    <textarea 
                        id="kamatsu-input" 
                        placeholder="96/100&#10;73/100&#10;67/100&#10;..."
                    ></textarea>
                    <p class="input-hint">Ví dụ: 96/100, 73/100</p>
                </div>
            </div>
        </section>

        <!-- Calculate Button -->
        <button id="calculate-btn" class="calculate-btn">
            <i class="fas fa-chart-line"></i>
            Tính Toán Điểm
        </button>

        <!-- Results Section -->
        <div id="results" class="results hidden">
            <!-- Current Status -->
            <section class="result-section">
                <h2 class="section-title">
                    <i class="fas fa-chart-line"></i>
                    Tình Trạng Hiện Tại
                </h2>
                <div class="status-grid">
                    <div class="status-card">
                        <div class="status-label">Điểm TB Minitest</div>
                        <div class="status-value blue" id="avg-minitest">-</div>
                        <div class="status-percent" id="minitest-percent">-</div>
                    </div>
                    <div class="status-card">
                        <div class="status-label">Điểm TB Kamatsu</div>
                        <div class="status-value yellow" id="avg-kamatsu">-</div>
                        <div class="status-percent" id="kamatsu-percent">-</div>
                    </div>
                    <div class="status-card">
                        <div class="status-label">Điểm Hiện Tại</div>
                        <div class="status-value green" id="current-score">-</div>
                        <div class="status-percent">Chưa tính cuối kỳ</div>
                    </div>
                </div>
            </section>

            <!-- Required Scores -->
            <section class="result-section">
                <h2 class="section-title">
                    <i class="fas fa-trophy"></i>
                    Điểm Cuối Kỳ Cần Thiết
                </h2>
                <div class="required-list">
                    <!-- Pass -->
                    <div class="required-card">
                        <div class="required-info">
                            <i class="fas fa-check-circle" id="pass-icon"></i>
                            <div>
                                <div class="required-title">Qua Môn (≥ 4.0)</div>
                                <div class="required-subtitle">Điểm tối thiểu để pass</div>
                            </div>
                        </div>
                        <div class="required-score" id="pass-score">-</div>
                    </div>

                    <!-- Grade B -->
                    <div class="required-card">
                        <div class="required-info">
                            <i class="fas fa-check-circle" id="b-icon"></i>
                            <div>
                                <div class="required-title">Điểm B (≥ 7.0)</div>
                                <div class="required-subtitle">Điểm để đạt loại khá</div>
                            </div>
                        </div>
                        <div class="required-score" id="b-score">-</div>
                    </div>

                    <!-- Grade A -->
                    <div class="required-card">
                        <div class="required-info">
                            <i class="fas fa-check-circle" id="a-icon"></i>
                            <div>
                                <div class="required-title">Điểm A (≥ 8.5)</div>
                                <div class="required-subtitle">Điểm để đạt loại giỏi</div>
                            </div>
                        </div>
                        <div class="required-score" id="a-score">-</div>
                    </div>
                </div>
            </section>

            <!-- Info Note -->
            <div class="info-note">
                <i class="fas fa-info-circle"></i>
                <div>
                    <p class="note-title">Lưu ý:</p>
                    <p>Điểm chuyên cần đã được tính là 10/10 (100%). Kết quả trên giả định bạn đạt full điểm chuyên cần và điểm bài tập về nhà.</p>
                </div>
            </div>
        </div>

        <!-- Error Message -->
        <div id="error" class="error-message hidden">
            <i class="fas fa-exclamation-circle"></i>
            <p id="error-text"></p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>